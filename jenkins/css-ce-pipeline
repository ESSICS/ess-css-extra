#!groovyâ€‹
pipeline {

  /*
   * Agent sets up which environment that the pipeline will execute inside.
   * Can be specified to label of certain slave set up a docker container
   */
  agent any

  /*
   * Environment sets up a map containing key : value pairs
   */
  environment {
    buildPath = 'Original-CS-Studio'
    sourceRepo = 'https://github.com/ControlSystemStudio/'
    branch = 'master'
    email = 'claudio.rosati@esss.se'
    pass1 = 'it works'
  }

  options {
    disableConcurrentBuilds() //Disallow concurrent executions of the Pipeline
    timeout(time:4, unit: 'HOURS') //Set a timeout period for the Pipeline run, after which Jenkins should abort the Pipeline
    timestamps()

  }
  stages {
    stage('clone css-extra'){
      steps {
        git(url: 'https://github.com/fjubben/ess-css-extra', branch: 'jespertest')
      }
    }
    stage('BuildAll') {
      steps {
        echo "hello $email"
        echo "hello ${env.WORKSPACE}"
        sh "ls ${env.WORKSPACE}/jenkins"
        echo "hello ${env.NODE_NAME}"
        echo "hello ${env.JOB_NAME}"
        echo "hello ${env.BUILD_ID}"
        build(job: '/home/jenkins/workspace/hellopipeline/jenkins/css-core-pipeline', parameters: [[$class: 'StringParameterValue', name: 'param1', value: "$pass1" ]])
      }
    }
  }



}
